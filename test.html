<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Mock Test — Banking Exams</title>
<style>
:root{
  --primary:#1e3e8e;
  --accent:#142c66;
  --good:#c7ffd1;
  --bad:#ffd1d1;
  --correct-bg:#c7ffd1;
  --wrong-bg:#ffd1d1;
}
*{box-sizing:border-box}
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#f5f7fb;color:#111}
.header{padding:14px;text-align:center;color:#fff;background:linear-gradient(90deg,var(--primary),var(--accent));font-size:18px}
.subheader{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:10px 14px;background:#fff;border-bottom:1px solid #eef2f6}
.timer{font-weight:700;color:var(--primary)}
.container{padding:14px;padding-bottom:110px;max-width:900px;margin:auto;}
.question-box{background:#fff;border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(16,24,40,0.05);margin-bottom:12px}
.qtext{font-size:16px;margin-bottom:12px}
.options .opt{display:flex;align-items:center;gap:10px;padding:10px;border-radius:8px;border:1px solid #e6eef8;margin-top:8px;background:#fff;cursor:pointer}
.options .opt input{transform:scale(1.2)}
.options .opt.correct{background:var(--correct-bg);border-color:green}
.options .opt.wrong{background:var(--wrong-bg);border-color:red}
.controls{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap;justify-content:space-between}
.btn{padding:10px 14px;border-radius:8px;border:none;font-weight:600;cursor:pointer}
.btn-primary{background:var(--primary);color:#fff}
.btn-ghost{background:#fff;border:1px solid #d1d6df;color:#333}
.submit-btn{background:#0f9d58;color:#fff;width:100%;padding:12px;border-radius:10px;border:none;margin-top:12px;font-weight:700}
.open-nav-btn{position:fixed;right:18px;top:86px;background:var(--primary);color:#fff;border:none;padding:10px 12px;border-radius:999px;box-shadow:0 6px 16px rgba(0,0,0,0.12);cursor:pointer;z-index:99}
#sideNav{height:100%;width:0;position:fixed;top:0;right:0;background:#fff;z-index:1200;overflow-x:hidden;transition:0.35s;padding-top:60px;box-shadow:-6px 0 20px rgba(0,0,0,0.12)}
.side-close{position:absolute;top:12px;right:16px;font-size:20px;cursor:pointer}
.nav-list{padding:10px;display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.nav-item{padding:10px;border-radius:8px;text-align:center;background:#f1f5f9;cursor:pointer;font-weight:700}
.nav-item.correct{background:var(--good)}
.nav-item.wrong{background:var(--wrong-bg)}
.nav-item.not-answered{background:#e0e0e0}
.result-box{background:#fff;padding:15px;border-radius:10px;box-shadow:0 6px 18px rgba(16,24,40,0.05);margin-bottom:12px}
.review-item{background:#fff;padding:12px;border-radius:10px;box-shadow:0 6px 18px rgba(16,24,40,0.05);margin-bottom:12px}
.correct{color:green;font-weight:700}
.wrong{color:red;font-weight:700}
.muted{color:#6b7280}
@media(max-width:480px){.qtext{font-size:15px}.open-nav-btn{top:70px}}
</style>
</head>
<body>

<div class="header">Banking Exams — Mock Test</div>

<div class="subheader">
  <div style="display:flex;gap:12px;align-items:center">
    <div style="font-weight:700">Test: <span id="testTitle">—</span></div>
    <div class="muted" id="qCount">Q0</div>
  </div>
  <div class="timer" id="timer">00:00</div>
</div>

<button class="open-nav-btn" onclick="openNav()" title="Open question navigator">☰</button>

<!-- Side Navigation -->
<div id="sideNav">
  <div class="side-close" onclick="closeNav()">✕</div>
  <div style="padding:12px">
    <div style="font-weight:700;margin-bottom:8px">Questions</div>
    <div id="navList" class="nav-list"></div>
  </div>
</div>

<!-- Test Container -->
<div class="container" id="testArea" style="display:none;">
  <div class="question-box" id="questionBox"></div>
  <div class="controls">
    <button class="btn btn-ghost" id="prevBtn" onclick="prevQ()">← Previous</button>
    <button class="btn btn-primary" id="nextBtn" onclick="nextQ()">Next →</button>
  </div>
  <button class="submit-btn" id="submitBtn" onclick="submitTest(false)">Submit Test</button>
</div>

<!-- Review Area -->
<div class="container" id="reviewArea" style="display:none;">
  <div class="result-box">
    <div id="resultMessage" style="font-size:18px;font-weight:700"></div>
    <div id="scoreText" style="margin-top:6px"></div>
  </div>
  <h3 style="margin-left:2px">Review Answers</h3>
  <div id="reviewList"></div>
</div>

<script>
let questions=[], current=0, answers={}, totalTime=0, timerRef=null, submitted=false, testId="test1", testTitle="Sample Test";
const sampleQuestions = {
  "test1":[
    {"q":"What is 15 + 27?","A":"35","B":"42","C":"50","D":"40","answer":"C"},
    {"q":"Which is the smallest prime number?","A":"2","B":"3","C":"5","D":"1","answer":"A"},
    {"q":"RBI controls ______ in India.","A":"Stock Market","B":"Money Supply","C":"Agriculture","D":"Railways","answer":"B"}
  ]
};
function $(id){return document.getElementById(id);}
(function initFromURL(){
  const params=new URLSearchParams(location.search);
  if(params.has('test')) testId=params.get('test');
  if(params.has('title')) testTitle=params.get('title');
})();
$('testTitle').innerText=testTitle;

function loadQuestions(){
  fetch('questions.json').then(r=>r.ok?r.json():Promise.reject()).then(data=>{
    if(!data[testId]) throw new Error('Test id not found in JSON');
    questions=data[testId]; startEngine();
  }).catch(_=>{questions=sampleQuestions[testId]||sampleQuestions['test1'];startEngine();});
}

function startEngine(){
  totalTime = questions.length * 60;
  generateNav();
  renderQuestion();
  $('testArea').style.display='block';
  startTimer();
}

function startTimer(){
  if(timerRef) clearInterval(timerRef);
  updateTimerDisplay();
  timerRef=setInterval(()=>{
    totalTime--; updateTimerDisplay();
    if(totalTime<=0){ clearInterval(timerRef); timerRef=null; submitTest(true); }
  },1000);
}

function updateTimerDisplay(){ 
  let m=Math.floor(totalTime/60); let s=totalTime%60; s=s<10?'0'+s:s; 
  $('timer').innerText = m+':'+s; 
}

function openNav(){ $('sideNav').style.width='320px'; }
function closeNav(){ $('sideNav').style.width='0'; }

function generateNav(){
  const nav=$('navList'); nav.innerHTML='';
  for(let i=0;i<questions.length;i++){
    const d=document.createElement('div'); d.id='nav'+i; d.className='nav-item not-answered'; d.innerText=(i+1); d.onclick=()=>jumpTo(i);
    nav.appendChild(d);
  }
}

function updateNavColors(){
  for(let i=0;i<questions.length;i++){
    const q=questions[i]; const user=answers[i]||null;
    const el=$('nav'+i); if(!el) continue;
    if(!user) el.className='nav-item not-answered';
    else if(user===q.answer) el.className='nav-item correct';
    else el.className='nav-item wrong';
  }
}

function renderQuestion(){
  const q = questions[current];
  const container = $('questionBox'); container.innerHTML = '';

  const qDiv = document.createElement('div'); qDiv.className='qtext'; qDiv.innerText=`${current+1}. ${q.q}`;
  container.appendChild(qDiv);

  const optsDiv = document.createElement('div'); optsDiv.className='options';
  ['A','B','C','D'].forEach(k=>{
    if(!q[k]) return;
    const opt = document.createElement('label'); opt.className='opt';
    const r = document.createElement('input'); r.type='radio'; r.name='opt'; r.value=k;
    r.onchange = function(){ if(!submitted){ answers[current]=this.value; updateNavColors(); } };
    if(answers[current]===k) r.checked=true;
    if(submitted){
      if(k===q.answer) opt.classList.add('correct');
      if(answers[current]===k && answers[current]!==q.answer) opt.classList.add('wrong');
      r.disabled=true;
    }
    opt.appendChild(r); opt.appendChild(document.createTextNode(k+'. '+q[k]));
    optsDiv.appendChild(opt);
  });
  container.appendChild(optsDiv);

  $('prevBtn').style.display = current===0?'none':'inline-block';
  $('nextBtn').style.display = current===questions.length-1?'none':'inline-block';
  $('submitBtn').style.display = current===questions.length-1?'block':'none';

  $('qCount').innerText=`Q ${current+1}/${questions.length}`;
  updateNavColors();
}

function nextQ(){
  if(!submitted){
    const sel=document.querySelector("input[name='opt']:checked");
    if(sel) answers[current]=sel.value;
  }
  if(current<questions.length-1){ current++; renderQuestion(); }
}

function prevQ(){
  if(current>0){ current--; renderQuestion(); }
}

function jumpTo(i){ if(i<0||i>=questions.length) return; current=i; renderQuestion(); closeNav(); }

function submitTest(auto=false){
  if(submitted) return; submitted=true;
  if(timerRef){ clearInterval(timerRef); timerRef=null; }
  updateNavColors();
  renderQuestion(); // to apply highlighting for current question

  $('reviewArea').style.display='block';
  const reviewList=$('reviewList'); reviewList.innerHTML='';
  let score=0;
  questions.forEach((q,i)=>{
    const user=answers[i]||'Not Attempted';
    if(user===q.answer) score++;
    const item=document.createElement('div'); item.className='review-item';
    item.innerHTML=`<div style="font-weight:700">Q${i+1}: ${q.q}</div>
      <div style="margin-top:6px">Your Answer: <span class="${user===q.answer?'correct':(user==='Not Attempted'?'muted':'wrong')}">${user}</span></div>
      <div>Correct Answer: <span class="correct">${q.answer}</span></div>`;
    reviewList.appendChild(item);
  });
  $('resultMessage').innerText = auto ? "Time's up — Test auto-submitted." : "Test submitted successfully.";
  $('scoreText').innerText = `Score: ${score} / ${questions.length} (${Math.round(score/questions.length*100)}%)`;
}

loadQuestions();
</script>
</body>
</html>
